#!/usr/bin/env ruby

$:.unshift File.dirname(__FILE__) + "/../lib"

require 'erb'
require 'wikileaks_mirror_count'

begin
  count = WikileaksMirrorCount.new('http://wikileaks.ch/mirrors.html').get
  template = ERB.new File.new('templates/index.erb').read, nil, '%'
  File.open('index.html', 'w') do |file|
    file.write template.result binding
  end
rescue StandardError
  # We let it silently fail if anything happens. No need to upset the monkeys.
end